<!doctype html>
<html lang="zxx">

<head>
   <!-- Required meta tags -->
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <title>aranoz</title>
   <link rel="icon" href="img/favicon.png">
   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="css/bootstrap.min.css">
   <!-- animate CSS -->
   <link rel="stylesheet" href="css/animate.css">
   <!-- owl carousel CSS -->
   <link rel="stylesheet" href="css/owl.carousel.min.css">
   <!-- nice select CSS -->
   <link rel="stylesheet" href="css/nice-select.css">
   <!-- font awesome CSS -->
   <link rel="stylesheet" href="css/all.css">
   <!-- flaticon CSS -->
   <link rel="stylesheet" href="css/flaticon.css">
   <link rel="stylesheet" href="css/themify-icons.css">
   <!-- font awesome CSS -->
   <link rel="stylesheet" href="css/magnific-popup.css">
   <!-- swiper CSS -->
   <link rel="stylesheet" href="css/slick.css">
   <link rel="stylesheet" href="css/price_rangs.css">
   <!-- style CSS -->
   <link rel="stylesheet" href="css/style.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<link rel="stylesheet" href="css/home.css">
    <style>
    .feature_part .single_feature_post_text {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
    padding: 20px;
    box-sizing: border-box;
    background-color: #f8f9fa;
    border-radius: 15px;
    overflow: hidden;
    text-align: center;
    margin-bottom: 20px;
    box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
    height: 400px; /* Fixed height for all boxes */
    width: 100%; /* Make the box width consistent */
    max-width: 100%; /* Ensures it doesn't overflow */
}

.feature_part .single_feature_post_text img {
    width: 100%;
    height: 70%; /* Takes up 70% of the container height */
    object-fit: cover; /* Ensure the image covers the container proportionally */
    border-radius: 15px;
    display: block;
}

.feature_part .single_feature_post_text h3 {
    margin-top: 15px;
    font-size: 1.5rem;
}

.feature_part .single_feature_post_text p {
    margin-top: 10px;
    font-size: 1rem;
    color: #6c757d;
}

    </style>
</head>

<body>
   
    <%- include('header') %>

    <!-- banner part start-->
    <section class="banner_part">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <div class="banner_slider owl-carousel">
                        <div class="single_banner_slider">
                            <div class="row">
                                <div class="col-lg-5 col-md-8">
                                    <div class="banner_text">
                                        <div class="banner_text_iner">
                                            <h1>Wood & Cloth
                                                Sofa</h1>
                                            <p>Incididunt ut labore et dolore magna aliqua quis ipsum
                                                suspendisse ultrices gravida. Risus commodo viverra</p>
                                            <a href="#" class="btn_2">buy now</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="banner_img d-none d-lg-block">
                                    <img src="img/banner_img.png" alt="">
                                </div>
                            </div>
                        </div><div class="single_banner_slider">
                            <div class="row">
                                <div class="col-lg-5 col-md-8">
                                    <div class="banner_text">
                                        <div class="banner_text_iner">
                                            <h1>Cloth & Wood
                                                Sofa</h1>
                                            <p>Incididunt ut labore et dolore magna aliqua quis ipsum
                                                suspendisse ultrices gravida. Risus commodo viverra</p>
                                            <a href="#" class="btn_2">buy now</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="banner_img d-none d-lg-block">
                                    <img src="img/banner_img.png" alt="">
                                </div>
                            </div>
                        </div><div class="single_banner_slider">
                            <div class="row">
                                <div class="col-lg-5 col-md-8">
                                    <div class="banner_text">
                                        <div class="banner_text_iner">
                                            <h1>Wood & Cloth
                                                Sofa</h1>
                                            <p>Incididunt ut labore et dolore magna aliqua quis ipsum
                                                suspendisse ultrices gravida. Risus commodo viverra</p>
                                            <a href="#" class="btn_2">buy now</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="banner_img d-none d-lg-block">
                                    <img src="img/banner_img.png" alt="">
                                </div>
                            </div>
                        </div>
                       
                    </div>
                    <div class="slider-counter"></div>
                </div>
            </div>
        </div>
    </section>
    <!-- banner part start-->

  
    
    
    <section class="cat_product_area section_padding padding_top">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="left_sidebar_area">
                        <aside class="left_widgets p_filter_widgets">
                            <div class="l_w_title">
                                <h3>Product Filter</h3>
                            </div>
                            <div class="widgets_inner">
                                <ul class="list">
                                    <li>
                                        <a = href="/shop" class="<%= !categoryFilter ? 'active' : '' %>">
                                        All Products
                                        </a>
                                    </li>
                                    <% if (categories && categories.length > 0) { %>
                                        <% categories.forEach(category => { %>
                                            <li><a  href="/shop?category=<%= category._id %>"><%= category.name %></a></li>
                                        <% }) %>
                                    <% } else { %>
                                        <li>No categories available</li>
                                    <% } %>
                                </ul>
                            </div>
                        </aside>

                       
                       

                        <aside class="left_widgets p_filter_widgets price_rangs_aside">
                            <div class="l_w_title">
                                <h3 style="text-align: center;">Price</h3>
                            </div>
                            <div class="widgets_inner">
                                <div class="range_item">
                                    <form id="price-filter-form" method="GET" action="/shop">
                                        <div class="d-flex">
                                            <div class="price_text">
                                                <p>From:</p>
                                            </div>
                                            <div class="price_value d-flex justify-content-center">
                                                <input type="text" name="minPrice" class="js-input-from" id="minPrice" placeholder="Min"  />
                                                <span>to</span>
                                                <input type="text" name="maxPrice" class="js-input-to" id="maxPrice" placeholder="Max"  />
                                            </div>
                                        </div>
                                        <button type="submit" class="apply-filter-btn">Apply</button>
                                    </form>
                                </div>
                            </div>
                        </aside>
                        
                                                
                        
                        
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="product_top_bar d-flex justify-content-between align-items-center">
                                <div class="single_product_menu">
                                   
                                </div>
                              
                                <div class="single_product_menu d-flex">
                                    <h5>sort by : </h5>
                                    <select id="sortOptions" onchange="applySort()">
                                        <option value="default" data-display="Select">Select</option>
                                        <option value="popularity">Popularity</option>
                                        <option value="priceAsc">Price: low to high</option>
                                        <option value="priceDesc">Price: high to low</option>
                                        <option value="averageRatings">Average ratings</option>
                                        <option value="featured">Featured</option>
                                        <option value="newArrivals">New arrivals</option>
                                        <option value="az">A - Z</option>
                                        <option value="za">Z - A</option>
                                    </select>
                                </div>
                                <div class="single_product_menu d-flex">
                                    <div class="input-group">
                                        <form action="/shop" method="GET" class="input-group">
                                            <input type="text" class="form-control" name="search" placeholder="Search" aria-describedby="inputGroupPrepend" value="<%= searchQuery %>">
                                            <div class="input-group-prepend">
                                                <button type="submit" class="input-group-text" id="inputGroupPrepend">
                                                    <i class="ti-search"></i>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <div class="single_product_menu d-flex">
                                    
                                    <div class="top_pageniation">
                                        <ul class="pagination justify-content-center" style="list-style: none; padding: 0;">
                                            <% for(let i = 1; i <= totalPages; i++) { %>
                                                <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                                    <a class="page-link" href="?page=<%= i %>&search=<%= searchQuery %>&sort=<%= sortOption %>"><%= i %></a>
                                                </li>
                                            <% } %>
                                        </ul>
                                    </div>
                                </div>
                               
                            </div>
                        </div>
                    </div>

                    <div class="row align-items-center latest_product_inner">
                        
                        <% if (products && products.length > 0) { %>
                            <% products.forEach(product => { %>
                                <div class="col-lg-4 col-sm-6">
                                    <div class="single_product_item">
                                        <a href="/product/<%= product._id %>">
                                            <img src="<%= product.productImage[0] %>" alt="<%= product.productName %>">
                                        </a>
                                        <div class="single_product_text">
                                            <h4><%= product.productName %></h4>
                                            <h3>â‚¹<%= product.salePrice %></h3>
                                            <button class="add-to-cart-btn" data-product-id="<%= product._id %>" onclick="addToCart('<%= product._id %>')">Add to Cart</button>
                                            <button 
                                            class="add-to-wishlist-btn <%= wishlistItems.includes(product._id.toString()) ? 'active' : '' %>" 
                                            data-product-id="<%= product._id %>" 
                                            onclick="toggleWishlist(this, '<%= product._id %>')">
                                            <i class="ti-heart"></i>
                                        </button>                                          
                                        </div>
                                    </div>
                                </div>
                            <% }) %>
                        <% } else { %>
                            <div class="col-12">
                                <p>No products available in this category</p>
                            </div>
                        <% } %>
                    </div>
                    <!-- Pagination -->
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center">
                            <% for(let i = 1; i <= totalPages; i++) { %>
                                <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                    <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                                </li>
                            <% } %>
                        </ul>
                    </nav>
                     
                </div>
            </div>
        </div>
    </section>
   
   

  


    <!-- subscribe_area part start-->
    <section class="client_logo ">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_1.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_2.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_3.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_4.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_5.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_3.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_1.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_2.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_3.png" alt="">
                    </div>
                    <div class="single_client_logo">
                        <img src="img/client_logo/client_logo_4.png" alt="">
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--::subscribe_area part end::-->

    <!--::footer_part start::-->
    <footer class="footer_part">
        <div class="container">
            <div class="row justify-content-around">
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Top Products</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Managed Website</a></li>
                            <li><a href="">Manage Reputation</a></li>
                            <li><a href="">Power Tools</a></li>
                            <li><a href="">Marketing Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Quick Links</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Jobs</a></li>
                            <li><a href="">Brand Assets</a></li>
                            <li><a href="">Investor Relations</a></li>
                            <li><a href="">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Features</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Jobs</a></li>
                            <li><a href="">Brand Assets</a></li>
                            <li><a href="">Investor Relations</a></li>
                            <li><a href="">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-2">
                    <div class="single_footer_part">
                        <h4>Resources</h4>
                        <ul class="list-unstyled">
                            <li><a href="">Guides</a></li>
                            <li><a href="">Research</a></li>
                            <li><a href="">Experts</a></li>
                            <li><a href="">Agencies</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-4">
                    <div class="single_footer_part">
                        <h4>Newsletter</h4>
                        <p>Heaven fruitful doesn't over lesser in days. Appear creeping
                        </p>
                        <div id="mc_embed_signup">
                            <form target="_blank"
                                action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                method="get" class="subscribe_form relative mail_part">
                                <input type="email" name="email" id="newsletter-form-email" placeholder="Email Address"
                                    class="placeholder hide-on-focus" onfocus="this.placeholder = ''"
                                    onblur="this.placeholder = ' Email Address '">
                                <button type="submit" name="submit" id="newsletter-submit"
                                    class="email_icon newsletter-submit button-contactForm">subscribe</button>
                                <div class="mt-10 info"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        <div class="copyright_part">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="copyright_text">
                            <P><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="ti-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></P>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="footer_icon social_icon">
                            <ul class="list-unstyled">
                                <li><a href="#" class="single_social_icon"><i class="fab fa-facebook-f"></i></a></li>
                                <li><a href="#" class="single_social_icon"><i class="fab fa-twitter"></i></a></li>
                                <li><a href="#" class="single_social_icon"><i class="fas fa-globe"></i></a></li>
                                <li><a href="#" class="single_social_icon"><i class="fab fa-behance"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--::footer_part end::-->

    <!-- jquery plugins here-->
    <script src="js/jquery-1.12.1.min.js"></script>
    <!-- popper js -->
    <script src="js/popper.min.js"></script>
    <!-- bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- easing js -->
    <script src="js/jquery.magnific-popup.js"></script>
    <!-- swiper js -->
    <script src="js/swiper.min.js"></script>
    <!-- swiper js -->
    <script src="js/masonry.pkgd.js"></script>
    <!-- particles js -->
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <!-- slick js -->
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>
    <!-- custom js -->
    <script src="js/custom.js"></script>
    <script>
            function applySort() {
    const sortValue = document.getElementById('sortOptions').value;
    window.location.href = `/shop?sort=${sortValue}`;
  }

  function addToCart(productId) {
    console.log('addToCart function called'); // Debug log
    console.log('Product ID:', productId); // Debug log
   
    fetch('/cart/add', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ productId })
    })
    .then(response => {
        console.log('Response received:', response); // Debug log
        return response.json();
    })
    .then(data => {
        console.log('Data received:', data); // Debug log
        if (data.success) {
            Swal.fire({
                icon: 'success',
                title: 'Success',
                text: 'Product added to cart successfully!',
                showConfirmButton: false,
                timer: 1500
            }).then(() => {
                window.location.href = '/cart'; // Redirect to cart page
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Failed to add product to cart',
            });
        }
    })
    .catch(error => console.error('Error:', error));
}
document.addEventListener('DOMContentLoaded', () => {
    fetch('/wishlist/count')
        .then(response => response.json())
        .then(data => {
            const wishlistCountElement = document.getElementById('wishlist-count');
            wishlistCountElement.innerText = data.wishlistCount || 0;
        })
        .catch(error => console.error('Error fetching wishlist count:', error));
});


function toggleWishlist(button, productId) {
    const isInWishlist = button.classList.contains('active');

    if (!isInWishlist) {
        console.log('Adding to wishlist...');

        fetch('/wishlist/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ productId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                button.classList.add('active');
                Swal.fire({
                    icon: 'success',
                    title: 'Success',
                    text: 'Product added to wishlist successfully!',
                    showConfirmButton: false,
                    timer: 1500
                }).then(() => {
                    // Update the wishlist count using the value returned from the server
                    const wishlistCountElement = document.getElementById('wishlist-count');
                    wishlistCountElement.innerText = data.wishlistCount || 0;
                    console.log('Wishlist count updated:', data.wishlistCount); // Debugging log
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: data.message || 'Failed to add product to wishlist',
                });
            }
        })
        .catch(error => {
            console.error('Error:', error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'An unexpected error occurred. Please try again later.',
            });
        });

    } else {
        Swal.fire({
            title: 'Are you sure?',
            text: "Do you want to remove this product from your wishlist?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Yes, remove it!'
        }).then((result) => {
            if (result.isConfirmed) {
                console.log('Removing from wishlist...');

                fetch('/wishlist/remove', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ productId })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        button.classList.remove('active');
                        Swal.fire({
                            icon: 'success',
                            title: 'Removed!',
                            text: 'Product has been removed from your wishlist.',
                            showConfirmButton: false,
                            timer: 1500
                        }).then(() => {
                            // Update the wishlist count using the value returned from the server
                            const wishlistCountElement = document.getElementById('wishlist-count');
                            wishlistCountElement.innerText = data.wishlistCount || 0;
                            console.log('Wishlist count updated:', data.wishlistCount); // Debugging log
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error',
                            text: data.message || 'Failed to remove product from wishlist',
                        });
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'An unexpected error occurred. Please try again later.',
                    });
                });
            }
        });
    }
}

    </script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>